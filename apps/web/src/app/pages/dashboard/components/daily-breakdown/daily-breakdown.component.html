<div class="daily-breakdown">
  <div class="daily-breakdown__header">
    <div>
      <h3>
        Dzienny rozkad
        @if (selectedMonth()) {
          <span>- {{ selectedMonth()?.label }}</span>
        }
      </h3>
      <p>Wybierz miesic w trendzie, aby zobaczy szczeg贸y.</p>
    </div>

    @if (selectedMonth()) {
      <button nz-button nzType="default" (click)="onClear()">
        Wyczy wyb贸r
      </button>
    }
  </div>

  @if (isLoading()) {
    <div class="daily-breakdown__skeleton">
      <nz-skeleton [nzActive]="true" [nzParagraph]="{ rows: 6 }" />
    </div>
  } @else if (!hasSelection()) {
    <app-empty-state
      icon=""
      title="Wybierz miesic"
      description="Kliknij w supek na wykresie trendu miesicznego, aby zobaczy dane dzienne."
    />
  } @else if (hasError()) {
    <app-empty-state
      icon="锔"
      title="Nie udao si pobra danych dziennych"
      description="Spr贸buj ponownie lub zmie zakres filtr贸w."
      actionLabel="Spr贸buj ponownie"
      actionType="primary"
      (action)="onRetry()"
    />
  } @else if (!hasData()) {
    <app-empty-state
      icon=""
      title="Brak zam贸wie"
      description="Nie znaleziono zam贸wie w wybranym miesicu."
      actionLabel="Wyczy wyb贸r"
      (action)="onClear()"
    />
  } @else {
    <div class="daily-breakdown__content">
      <div
        echarts
        class="daily-breakdown__chart"
        [options]="chartOptions()"
        [autoResize]="true"
      ></div>

      <nz-table
        class="daily-breakdown__table"
        [nzData]="sortedData()"
        nzSize="small"
        nzBordered
      >
        <thead>
          <tr>
            <th
              nzShowSort
              nzColumnKey="day"
              [nzSortOrder]="sortOrderFor('day')"
              (nzSortOrderChange)="onSort('day', $event)"
            >
              Dzie
            </th>
            <th
              nzShowSort
              nzColumnKey="net"
              [nzSortOrder]="sortOrderFor('netPln')"
              (nzSortOrderChange)="onSort('netPln', $event)"
            >
              Suma netto (PLN)
            </th>
            <th
              nzShowSort
              nzColumnKey="orders"
              [nzSortOrder]="sortOrderFor('ordersCount')"
              (nzSortOrderChange)="onSort('ordersCount', $event)"
            >
              Liczba zam贸wie
            </th>
          </tr>
        </thead>
        <tbody>
          @for (row of sortedData(); track row.date) {
            <tr>
              <td>{{ row.day }}</td>
              <td>{{ row.formattedNet }}</td>
              <td>{{ row.ordersCount }}</td>
            </tr>
          }
        </tbody>
      </nz-table>
    </div>
  }
</div>


