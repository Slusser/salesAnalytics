<section class="customers-page">
  <header class="page-header">
    <h2>Kontrahenci</h2>
    <div class="page-header__actions">
      @if (canMutate()) {
        <button
          nz-button
          nzType="primary"
          [disabled]="loading()"
          (click)="onCreate()"
        >
          Dodaj
        </button>
      }
      <app-manual-refresh-button
        [disabled]="loading()"
        (clicked)="onManualRefresh()"
      />
    </div>
  </header>

  <app-filter-bar
    [value]="filters()"
    [role]="roles()"
    (changed)="onFilterChange($event)"
  />

  @if (showError()) {
    <nz-alert
      nzType="error"
      nzMessage="Nie udało się pobrać listy kontrahentów"
      nzDescription="Spróbuj odświeżyć stronę lub zmień filtry."
      [nzShowIcon]="true"
    >
      <ng-template #nzAction>
        <button nz-button nzType="primary" (click)="onRetry()">Spróbuj ponownie</button>
      </ng-template>
    </nz-alert>
  }

  @if (showEmpty()) {
    <app-empty-state
      title="Brak kontrahentów"
      description="Nie znaleziono kontrahentów dla podanych filtrów."
      [hasCta]="true"
      (clear)="onClearFilters()"
    />
  } @else {
    <app-customers-table
      [items]="items()"
      [role]="roles()"
      [loading]="loading()"
      (edit)="onEdit($event)"
      (softDelete)="onSoftDelete($event)"
      (restore)="onRestore($event)"
    />

    <app-pagination
      [page]="params().page"
      [limit]="params().limit"
      [total]="total()"
      [disabled]="loading()"
      (pageChange)="onPageChange($event)"
      (limitChange)="onLimitChange($event)"
    />
  }

  <app-confirm-dialog
    [open]="confirmDialogOpen()"
    [title]="confirmDialogTitle()"
    [description]="confirmDialogDescription()"
    [customerName]="confirmDialogCustomerName()"
    [loading]="confirmDialogLoading()"
    confirmLabel="Potwierdź"
    cancelLabel="Anuluj"
    (confirmed)="onConfirmDialogConfirm()"
    (closed)="onConfirmDialogClose()"
  />
</section>


